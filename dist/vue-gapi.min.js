/*!
 * vue-gapi v0.0.8
 * (c) 2018 CedricPoilly
 * Released under the MIT License.
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.VueGapi=t.VueGapi||{})}(this,function(t){"use strict";var e,n=(e="https://apis.google.com/js/api.js",new Promise(function(t,n){var i=document.createElement("script");i.src=e,i.onreadystatechange=i.onload=function(){var e=setInterval(function(){i.readyState&&!/loaded|complete/.test(i.readyState)||(clearInterval(e),console.log("gapi.js loaded."),t())},100)},document.getElementsByTagName("head")[0].appendChild(i)})),i=function(){this.authenticated=this.isAuthenticated(),this.authInstance=null,this.login=this.login.bind(this),this.setSession=this.setSession.bind(this),this.logout=this.logout.bind(this),this.isAuthenticated=this.isAuthenticated.bind(this)};i.prototype.login=function(t){return this.authInstance.signIn().then(this.setSession)},i.prototype.logout=function(t){this.authInstance.signOut(function(t){return console.log(t)}),localStorage.clear(),this.authenticated=!1},i.prototype.setSession=function(t){var e=this.authInstance.currentUser.get().getBasicProfile(),n=t.Zi,i=JSON.stringify(1e3*n.expires_in+(new Date).getTime());localStorage.setItem("access_token",n.access_token),localStorage.setItem("id_token",n.id_token),localStorage.setItem("expires_at",i),this.authenticated=!0,localStorage.setItem("id",e.getId()),localStorage.setItem("full_name",e.getName()),localStorage.setItem("first_name",e.getGivenName()),localStorage.setItem("last_name",e.getFamilyName()),localStorage.setItem("image_url",e.getImageUrl()),localStorage.setItem("email",e.getEmail())},i.prototype.isAuthenticated=function(){var t=JSON.parse(localStorage.getItem("expires_at"));return(new Date).getTime()<t},i.prototype.getUserData=function(){return{firstName:localStorage.getItem("first_name"),lastName:localStorage.getItem("last_name"),email:localStorage.getItem("email")}};var o=new i,a=o.login,s=o.logout,l=o.isAuthenticated,r=o.getUserData,c={install:function(t,e){t.gapiLoadClientPromise=null;t.prototype.$getGapiClient=function(){return new Promise(function(i,a){var s;t.gapiLoadClientPromise&&0===t.gapiLoadClientPromise.status?i(t.gapiLoadClientPromise):(s=i,n.then(function(n){var i=window.gapi;i?i.auth?s(i):i.load("client:auth2",function(){t.gapiLoadClientPromise=i.client.init(e).then(function(){console.info("gapi client initialised."),o.authInstance=i.auth2.getAuthInstance(),s(i)})}):console.error("Failed to load GAPI!")}))})},t.prototype.$login=function(){return t.prototype.$getGapiClient().then(a)},t.prototype.$logout=function(){return t.prototype.$getGapiClient().then(s)},t.prototype.$isAuthenticated=l,t.prototype.$getUserData=r}};function u(t,e){t.use(c,e)}"undefined"!=typeof window&&window.Vue&&window.Vue.use(u);t.default=u,t.version="0.0.8",Object.defineProperty(t,"__esModule",{value:!0})});